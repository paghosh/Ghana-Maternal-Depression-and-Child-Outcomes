-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers
> /OU/Health/Ghana_mental_health/maternal_depression_child_cog_devlopment/progr
> ams/stata/Draft1_Feb2026/00_data_cleaning.log
  log type:  text
 opened on:  21 Feb 2026, 21:07:06

. 
. /*===========================================================================
> ===
>     PART 1: PROCESS WAVE 1 DATA
> =============================================================================
> =*/
. 
. /*--- 1A. Household Roster & Demographics (Wave 1) ---*/
. use "$data/Wave 1/s1d.dta", clear

. 
. rename s1d_1 gender

. rename s1d_2 relationship

. rename s1d_4i age

. rename s1d_4ii age_months

. 
. /* Identify mothers and children.
>    Gender and relationship may be string or numeric with value labels.
>    Use decode to handle numeric case. */
. cap confirm string variable gender

. if _rc == 0 {
.     gen female = (gender == "Female")
. }

. else {
.     decode gender, gen(gender_str)
.     gen female = (gender_str == "Female")
.     drop gender_str
. }

. 
. cap confirm string variable relationship

. if _rc == 0 {
.     gen mother = (female == 1) & ///
>         (relationship == "Household Head" | relationship == "Spouse" | ///
>          relationship == "Parent/Parent-in-Law") & ///
>         (age >= 15 & age < .)
.     gen child = (relationship == "Child" | ///
>         relationship == "Adopted/Foster/Stepchild" | ///
>         relationship == "Grandchild") & ///
>         (age >= 0 & age <= 17)
. }

. else {
.     decode relationship, gen(rel_str)
.     gen mother = (female == 1) & ///
>         (rel_str == "Household Head" | rel_str == "Spouse" | ///
>          rel_str == "Parent/Parent-in-Law") & ///
>         (age >= 15 & age < .)
.     gen child = (rel_str == "Child" | ///
>         rel_str == "Adopted/Foster/Stepchild" | ///
>         rel_str == "Grandchild") & ///
>         (age >= 0 & age <= 17)
.     drop rel_str
. }

. 
. gen child_female = (child == 1 & female == 1)

. 
. /* Ethnicity (for matrilineal/patrilineal identification) */
. rename s1d_15 ethnicity_w1

. 
. /* Keep relevant variables */
. keep FPrimary hhid hhmid gender relationship age age_months female ///
>     mother child child_female ethnicity_w1

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. 
. save "$temp/w1_demographics.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_demographics.dta saved

. 
. /*--- 1B. Depression Module (Wave 1) - K10 Scale ---*/
. use "$data/Wave 1/s10ai.dta", clear

. 
. /* K10 items: s10ai_a1 through s10ai_a10
>    Response categories: None of the time(1), A little(2), Some(3),
>    Most(4), All of the time(5) */
. 
. /* K10 items may be numeric (1-5) with value labels, or string.
>    Handle both cases robustly. */
. foreach var of varlist s10ai_a1-s10ai_a10 {
  2.     cap confirm string variable `var'
  3.     if _rc == 0 {
  4.         /* String variable: recode from text to numeric */
.         gen `var'_n = .
  5.         replace `var'_n = 1 if `var' == "None of the time"
  6.         replace `var'_n = 2 if `var' == "A little of the time"
  7.         replace `var'_n = 3 if `var' == "Some of the time"
  8.         replace `var'_n = 4 if `var' == "Most of the time"
  9.         replace `var'_n = 5 if `var' == "All of the time"
 10.     }
 11.     else {
 12.         /* Numeric variable (already coded 1-5): use directly */
.         gen `var'_n = `var'
 13.     }
 14. }
(44 missing values generated)
(53 missing values generated)
(59 missing values generated)
(58 missing values generated)
(135 missing values generated)
(76 missing values generated)
(67 missing values generated)
(87 missing values generated)
(129 missing values generated)
(147 missing values generated)

. 
. /* Construct K10 depression score (sum of 10 items, range 10-50) */
. egen k10_score = rowtotal(s10ai_a1_n s10ai_a2_n s10ai_a3_n s10ai_a4_n ///
>     s10ai_a5_n s10ai_a6_n s10ai_a7_n s10ai_a8_n s10ai_a9_n s10ai_a10_n), miss
> ing
(29 missing values generated)

. replace k10_score = . if missing(s10ai_a1_n) & missing(s10ai_a2_n) & ///
>     missing(s10ai_a3_n)
(4 real changes made, 4 to missing)

. 
. /* Depression severity categories (standard K10 cutoffs) */
. gen depression_cat = .
(10,041 missing values generated)

. replace depression_cat = 0 if k10_score >= 10 & k10_score <= 19   // Low
(5,557 real changes made)

. replace depression_cat = 1 if k10_score >= 20 & k10_score <= 24   // Mild
(2,346 real changes made)

. replace depression_cat = 2 if k10_score >= 25 & k10_score <= 29   // Moderate
(1,271 real changes made)

. replace depression_cat = 3 if k10_score >= 30 & k10_score <= 50   // Severe
(802 real changes made)

. 
. gen depressed_binary = (k10_score >= 20) if k10_score < .
(33 missing values generated)

. 
. /* Also use the pre-constructed depression score if available */
. rename depressed depressed_precoded

. rename depression depression_score_precoded

. 
. /* Standardize K10 score */
. egen k10_std = std(k10_score)
(33 missing values generated)

. 
. keep FPrimary hhid hhmid k10_score k10_std depression_cat depressed_binary //
> /
>     depressed_precoded depression_score_precoded ///
>     s10ai_a1_n s10ai_a2_n s10ai_a3_n s10ai_a4_n s10ai_a5_n ///
>     s10ai_a6_n s10ai_a7_n s10ai_a8_n s10ai_a9_n s10ai_a10_n

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. 
. save "$temp/w1_depression.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_depression.dta saved

. 
. /*--- 1C. Cognitive Tests (Wave 1) - Children Only ---*/
. 
. /* Raven's Progressive Matrices */
. use "$data/Wave 1/s9c.dta", clear

. rename s9c_ii hhmid

. 
. /* Correct answers for Raven's Set A (standard key):
>    c1=4, c2=5, c3=1, c4=2, c5=6, c6=3, c7=6, c8=2, c9=1, c10=3, c11=5, c12=2 
> */
. local correct_c1  "D"

. local correct_c2  "E"

. local correct_c3  "A"

. local correct_c4  "B"

. local correct_c5  "F"

. local correct_c6  "C"

. local correct_c7  "F"

. local correct_c8  "B"

. local correct_c9  "A"

. local correct_c10 "C"

. local correct_c11 "E"

. local correct_c12 "B"

. 
. gen ravens_correct = 0

. /* Check if Raven's answers are string or numeric with value labels */
. cap confirm string variable s9c_c1

. if _rc == 0 {
.     /* String variable: compare letter answers directly */
.     forvalues i = 1/12 {
  2.         local j = string(`i')
  3.         cap gen temp_correct_`j' = (upper(s9c_c`j') == upper("`correct_c`j
> ''"))
  4.         cap replace ravens_correct = ravens_correct + temp_correct_`j' if 
> temp_correct_`j' < .
  5.         cap drop temp_correct_`j'
  6.     }
. }

. else {
.     /* Numeric with value labels: decode first */
.     forvalues i = 1/12 {
  2.         local j = string(`i')
  3.         cap decode s9c_c`j', gen(_tmp_r`j')
  4.         cap gen temp_correct_`j' = (upper(_tmp_r`j') == upper("`correct_c`
> j''"))
  5.         cap replace ravens_correct = ravens_correct + temp_correct_`j' if 
> temp_correct_`j' < .
  6.         cap drop temp_correct_`j' _tmp_r`j'
  7.     }
. }

. 
. /* Standardize ravens score */
. egen ravens_std = std(ravens_correct)

. 
. keep FPrimary hhid hhmid ravens_correct ravens_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(13 observations deleted)

. gen wave = 1

. save "$temp/w1_ravens.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_ravens.dta saved

. 
. /* Digit Span Forward */
. use "$data/Wave 1/s9b1.dta", clear

. rename s9b1_ii hhmid

. 
. /* Score = highest level where at least one trial is correct.
>    Items may be string ("Correct") or numeric with value labels.
>    Use decode to handle both cases. */
. gen dsf_score = 0

. forvalues lev = 1/8 {
  2.     local l = string(`lev')
  3.     /* Try string comparison first; if fails, decode and compare */
.     cap confirm string variable s9b1_b`l'a
  4.     if _rc == 0 {
  5.         cap gen pass_`l' = (s9b1_b`l'a == "Correct" | s9b1_b`l'b == "Corre
> ct" | ///
>             s9b1_b`l'c == "Correct") if !missing(s9b1_b`l'a)
  6.     }
  7.     else {
  8.         /* Numeric with value labels: decode to string, then compare */
.         cap decode s9b1_b`l'a, gen(_tmp_a)
  9.         cap decode s9b1_b`l'b, gen(_tmp_b)
 10.         cap decode s9b1_b`l'c, gen(_tmp_c)
 11.         cap gen pass_`l' = (_tmp_a == "Correct" | _tmp_b == "Correct" | //
> /
>             _tmp_c == "Correct") if !missing(s9b1_b`l'a)
 12.         cap drop _tmp_a _tmp_b _tmp_c
 13.     }
 14.     cap replace dsf_score = `lev' if pass_`l' == 1
 15. }

. cap drop pass_*

. 
. egen dsf_std = std(dsf_score)
(5,207 missing values generated)

. keep FPrimary hhid hhmid dsf_score dsf_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(12 observations deleted)

. gen wave = 1

. save "$temp/w1_dsf.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_dsf.dta saved

. 
. /* Digit Span Backward */
. use "$data/Wave 1/s9b2.dta", clear

. /* In Wave 1, s9b2 does not have hhmid directly - use same merge as s9b1 */
. /* The digit span backward starts at level 9 */
. gen dsb_score = 0

. forvalues lev = 9/15 {
  2.     local l = string(`lev')
  3.     cap confirm string variable s9b2_b`l'a
  4.     if _rc == 0 {
  5.         cap gen pass_`l' = (s9b2_b`l'a == "Correct" | s9b2_b`l'b == "Corre
> ct" | ///
>             s9b2_b`l'c == "Correct") if !missing(s9b2_b`l'a)
  6.     }
  7.     else {
  8.         cap decode s9b2_b`l'a, gen(_tmp_a)
  9.         cap decode s9b2_b`l'b, gen(_tmp_b)
 10.         cap decode s9b2_b`l'c, gen(_tmp_c)
 11.         cap gen pass_`l' = (_tmp_a == "Correct" | _tmp_b == "Correct" | //
> /
>             _tmp_c == "Correct") if !missing(s9b2_b`l'a)
 12.         cap drop _tmp_a _tmp_b _tmp_c
 13.     }
 14.     cap replace dsb_score = (`lev' - 8) if pass_`l' == 1
 15. }

. cap drop pass_*

. 
. /* Need hhmid - use s9b2_i or merge via row position */
. cap rename s9b2_i hhmid

. cap rename s9b2_iii hhmid

. 
. egen dsb_std = std(dsb_score)
(5,207 missing values generated)

. keep FPrimary hhid hhmid dsb_score dsb_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(2,052 observations deleted)

. gen wave = 1

. save "$temp/w1_dsb.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_dsb.dta saved

. 
. /* Math Test */
. use "$data/Wave 1/s9d.dta", clear

. rename s9d_id hhmid

. 
. /* Score items s9d_1 through s9d_8. Handle string vs numeric. */
. gen math_correct = 0

. cap confirm string variable s9d_1

. if _rc == 0 {
.     /* String: compare directly */
.     forvalues i = 1/8 {
  2.         cap replace math_correct = math_correct + (s9d_`i' == "Correct") i
> f !missing(s9d_`i')
  3.     }
. }

. else {
.     /* Numeric with value labels: decode and compare */
.     forvalues i = 1/8 {
  2.         cap decode s9d_`i', gen(_tmp_d`i')
  3.         cap replace math_correct = math_correct + (_tmp_d`i' == "Correct")
>  if !missing(s9d_`i')
  4.         cap drop _tmp_d`i'
  5.     }
. }

. 
. egen math_std = std(math_correct)
(5,294 missing values generated)

. keep FPrimary hhid hhmid math_correct math_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(148 observations deleted)

. gen wave = 1

. save "$temp/w1_math.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_math.dta saved

. 
. /* English Test */
. use "$data/Wave 1/s9e.dta", clear

. rename s9d_ie hhmid

. 
. gen english_correct = 0

. cap confirm string variable s9e_9

. if _rc == 0 {
.     forvalues i = 9/16 {
  2.         cap replace english_correct = english_correct + (s9e_`i' == "Corre
> ct") if !missing(s9e_`i')
  3.     }
. }

. else {
.     forvalues i = 9/16 {
  2.         cap decode s9e_`i', gen(_tmp_e`i')
  3.         cap replace english_correct = english_correct + (_tmp_e`i' == "Cor
> rect") if !missing(s9e_`i')
  4.         cap drop _tmp_e`i'
  5.     }
. }

. 
. egen english_std = std(english_correct)
(4,676 missing values generated)

. keep FPrimary hhid hhmid english_correct english_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(153 observations deleted)

. gen wave = 1

. save "$temp/w1_english.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_english.dta saved

. 
. /*--- 1D. Anthropometry (Wave 1) ---*/
. use "$data/Wave 1/s6b.dta", clear

. 
. rename s6b_4 height_cm

. rename s6b_5 weight_kg

. rename s6b_8 arm_circumference

. 
. /* We will compute z-scores after merging with demographics (need age/sex) */
. keep FPrimary hhid hhmid height_cm weight_kg arm_circumference

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(1 observation deleted)

. gen wave = 1

. save "$temp/w1_anthro.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_anthro.dta saved

. 
. /*--- 1E. Education (Wave 1) ---*/
. use "$data/Wave 1/s1fi.dta", clear

. 
. rename s1fi_hhmid hhmid

. 
. /* Highest grade attained */
. rename s1fi_3 highest_grade_w1

. rename s1fi_2 ever_attended_w1

. 
. /* Currently attending */
. cap confirm string variable s1fi_5

. if _rc == 0 {
.     gen attending_school = (s1fi_5 == "Yes") if !missing(s1fi_5)
. }

. else {
.     cap decode s1fi_5, gen(_tmp_sch)
.     gen attending_school = (_tmp_sch == "Yes") if !missing(s1fi_5)
(6,223 missing values generated)
.     cap drop _tmp_sch
. }

. 
. keep FPrimary hhid hhmid highest_grade_w1 ever_attended_w1 attending_school

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(2 observations deleted)

. gen wave = 1

. save "$temp/w1_education.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_education.dta saved

. 
. /*--- 1F. Employment & Earnings (Wave 1) ---*/
. use "$data/Wave 1/s1ei.dta", clear

. 
. rename s1ei_7i weeks_year

. rename s1ei_7ii days_week

. rename s1ei_7iii hours_day

. rename s1ei_10i pay_amount

. 
. /* Annualize earnings based on pay period (s1ei_11) */
. gen annual_hours = weeks_year * days_week * hours_day
(160 missing values generated)

. gen weekly_hours = days_week * hours_day
(150 missing values generated)

. 
. keep FPrimary hhid hhmid weeks_year days_week hours_day pay_amount ///
>     annual_hours weekly_hours s1ei_11

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. save "$temp/w1_employment.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_employment.dta saved

. 
. /*--- 1G. Health - Past 2 Weeks (Wave 1) ---*/
. use "$data/Wave 1/s6f.dta", clear

. 
. /* Read with convert_categoricals workaround if needed */
. destring s6f_1, replace force
s6f_1 already numeric; no replace

. destring s6f_5, replace force
s6f_5 already numeric; no replace

. destring s6f_6, replace force
s6f_6 already numeric; no replace

. destring s6f_7, replace force
s6f_7 already numeric; no replace

. destring s6f_8, replace force
s6f_8 already numeric; no replace

. 
. rename s6f_1 ill_2weeks

. rename s6f_5 days_sick

. rename s6f_6 stopped_activities

. rename s6f_7 days_stopped

. rename s6f_8 consulted_facility

. 
. keep FPrimary hhid hhmid ill_2weeks days_sick stopped_activities ///
>     days_stopped consulted_facility

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. save "$temp/w1_health2wk.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_health2wk.dta saved

. 
. /*--- 1H. Immunization (Wave 1) ---*/
. use "$data/Wave 1/s6c.dta", clear

. 
. /* Count vaccines received: s6c_2 BCG, s6c_3 polio, s6c_4 DPT,
>    s6c_5 five-in-one, s6c_6 measles, s6c_7 vitamin A, s6c_8 yellow fever */
. gen immun_count = 0

. cap confirm string variable s6c_2

. if _rc == 0 {
.     foreach var in s6c_2 s6c_3 s6c_4 s6c_5 s6c_6 s6c_7 s6c_8 {
  2.         replace immun_count = immun_count + (`var' == "Yes") if !missing(`
> var')
  3.     }
. }

. else {
.     foreach var in s6c_2 s6c_3 s6c_4 s6c_5 s6c_6 s6c_7 s6c_8 {
  2.         cap decode `var', gen(_tmp_v)
  3.         cap replace immun_count = immun_count + (_tmp_v == "Yes") if !miss
> ing(`var')
  4.         cap drop _tmp_v
  5.     }
. }

. gen immun_rate = immun_count / 7

. 
. keep FPrimary hhid hhmid immun_count immun_rate

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. save "$temp/w1_immunization.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_immunization.dta saved

. 
. /*--- 1I. Insurance (Wave 1) ---*/
. use "$data/Wave 1/s6a.dta", clear

. 
. cap confirm string variable s6a_a1

. if _rc == 0 {
.     gen nhis_registered = (s6a_a1 == "Yes") if !missing(s6a_a1)
.     gen nhis_valid_card = (s6a_a5 == "Yes, Card seen" | s6a_a5 == "Yes, No ca
> rd seen") ///
>         if !missing(s6a_a5)
. }

. else {
.     decode s6a_a1, gen(_tmp1)
.     gen nhis_registered = (_tmp1 == "Yes") if !missing(s6a_a1)
.     drop _tmp1
.     decode s6a_a5, gen(_tmp5)
.     gen nhis_valid_card = (_tmp5 == "Yes, Card seen" | _tmp5 == "Yes, No card
>  seen") ///
>         if !missing(s6a_a5)
(9,653 missing values generated)
.     drop _tmp5
. }

. 
. keep FPrimary hhid hhmid nhis_registered nhis_valid_card

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. save "$temp/w1_insurance.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_insurance.dta saved

. 
. /*--- 1J. Care for Kids / Time Use (Wave 1) ---*/
. use "$data/Wave 1/s10avi.dta", clear

. 
. /* Wave 1 time use has numbered activity items (s10avi_49 through s10avi_105)
>    The structure is: activity yes/no, then hours, minutes for each
>    We need to identify reading/homework-related activities */
. 
. /* For Wave 1, we will construct total time spent with children
>    by summing hours across activities where person reports doing them */
. 
. /* Total hours columns are the even-numbered: s10avi_50i, s10avi_52i, etc. */
. /* Minutes are: s10avi_50ii, s10avi_52ii, etc. */
. /* Let's sum all activities' time as total parental time */
. 
. /* Simplified: sum up all hour entries */
. egen total_time_hrs = rowtotal(s10avi_50i s10avi_52i s10avi_54i ///
>     s10avi_56i s10avi_58i s10avi_60i s10avi_62i s10avi_64i s10avi_66i ///
>     s10avi_68i s10avi_70i s10avi_72i s10avi_74i s10avi_76i s10avi_78i ///
>     s10avi_80i s10avi_82i s10avi_84i s10avi_86i s10avi_88i s10avi_90i ///
>     s10avi_92i s10avi_94i s10avi_96i s10avi_98i s10avi_100i s10avi_102i), mis
> sing
(3,646 missing values generated)

. 
. egen total_time_min = rowtotal(s10avi_50ii s10avi_52ii s10avi_54ii ///
>     s10avi_56ii s10avi_58ii s10avi_60ii s10avi_62ii s10avi_64ii s10avi_66ii /
> //
>     s10avi_68ii s10avi_70ii s10avi_72ii s10avi_74ii s10avi_76ii s10avi_78ii /
> //
>     s10avi_80ii s10avi_82ii s10avi_84ii s10avi_86ii s10avi_88ii s10avi_90ii /
> //
>     s10avi_92ii s10avi_94ii s10avi_96ii s10avi_98ii s10avi_100ii s10avi_102ii
> ), missing
(3,857 missing values generated)

. 
. gen total_parental_time = total_time_hrs + total_time_min / 60
(4,179 missing values generated)

. 
. /* Days per week working on childcare */
. rename s10avi_105 days_childcare_week_w1

. 
. keep FPrimary hhid hhmid total_parental_time days_childcare_week_w1

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 1

. save "$temp/w1_childcare.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_childcare.dta saved

. 
. /*--- 1K. Food Consumption (Wave 1) ---*/
. use "$data/Wave 1/s11a.dta", clear

. 
. /* Aggregate food consumption at the household level */
. /* s11a_bii = own-produced value (cedis), s11a_cii = purchased value */
. collapse (sum) food_own = s11a_bii food_purch = s11a_cii, by(FPrimary hhid)

. gen total_food_exp = food_own + food_purch

. 
. gen wave = 1

. save "$temp/w1_foodcons.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_foodcons.dta saved

. 
. /*--- 1L. Non-Food Consumption (Wave 1) ---*/
. /* Clothing */
. use "$data/Wave 1/s11b.dta", clear

. collapse (sum) clothing_exp = s11ba_2, by(FPrimary hhid)

. gen wave = 1

. save "$temp/w1_clothing.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_clothing.dta saved

. 
. /* Other items (education, health, etc.) */
. use "$data/Wave 1/s11c.dta", clear

. collapse (sum) other_exp = s11c_2, by(FPrimary hhid)

. gen wave = 1

. save "$temp/w1_otheritems.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_otheritems.dta saved

. 
. /* Fuel */
. use "$data/Wave 1/s11d.dta", clear

. collapse (sum) fuel_exp = s11d_a, by(FPrimary hhid)

. gen wave = 1

. save "$temp/w1_fuel.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_fuel.dta saved

. 
. /*--- 1M. Household Info (Wave 1) ---*/
. use "$data/Wave 1/key_hhld_info.dta", clear

. keep FPrimary hhid urbrur hhweight3 ppweight3

. rename hhweight3 hh_weight

. rename ppweight3 pp_weight

. gen wave = 1

. save "$temp/w1_hhinfo.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_hhinfo.dta saved

. 
. /*--- 1N. Household Cover (Wave 1) - for household size, region ---*/
. use "$data/Wave 1/sec0.dta", clear

. keep FPrimary hhid regioncode districtcode eacode urbrur threezones

. gen wave = 1

. save "$temp/w1_hhcover.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_hhcover.dta saved

. 
. 
. /*===========================================================================
> ===
>     PART 2: PROCESS WAVE 2 DATA
> =============================================================================
> =*/
. 
. /*--- 2A. Demographics (Wave 2) ---*/
. use "$data/Wave 2/01d_background.dta", clear
(b01d_background)

. 
. rename age age_w2

. rename gender gender_w2

. 
. cap confirm string variable gender_w2

. if _rc == 0 {
.     gen female = (gender_w2 == "Female")
. }

. else {
.     decode gender_w2, gen(_gender_str)
.     gen female = (_gender_str == "Female")
.     drop _gender_str
. }

. gen mother_w2 = 0

. 
. /* Need roster for relationship - merge with roster file */
. save "$temp/w2_background_temp.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_background_temp.dta saved

. 
. use "$data/Wave 2/01b2_roster.dta", clear
(bb01b2_roster)

. /* Wave 2 roster */
. keep FPrimary InstanceNumber hhmid

. rename InstanceNumber instance_roster

. save "$temp/w2_roster_ids.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_roster_ids.dta saved

. 
. use "$temp/w2_background_temp.dta", clear
(b01d_background)

. /* In Wave 2, InstanceNumber matches across files within FPrimary */
. /* hhmid is the consistent member ID */
. 
. gen mother_w2_v2 = (female == 1) & (age_w2 >= 15 & age_w2 < .)

. 
. gen child_w2 = (age_w2 >= 0 & age_w2 <= 17)

. 
. keep FPrimary InstanceNumber hhmid age_w2 gender_w2 female mother_w2_v2 ///
>     child_w2 maritalstatus religion ethnicity motherid fatherid

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_demographics.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_demographics.dta saved

. 
. /*--- 2B. Depression (Wave 2) ---*/
. use "$data/Wave 2/10ai_depression.dta", clear
(b10ai_depression)

. 
. /* K10 items have descriptive names in Wave 2.
>    Items may be numeric (1-5 with value labels) or string. Handle both. */
. foreach var in tired nervous hopeless restless depressed ///
>     everythingeffort nothingcheerup worthless sonervous sorestless {
  2.     cap confirm string variable `var'
  3.     if _rc == 0 {
  4.         /* String variable: recode from text to numeric */
.         gen `var'_n = .
  5.         replace `var'_n = 1 if `var' == "None of the time"
  6.         replace `var'_n = 2 if `var' == "A little of the time"
  7.         replace `var'_n = 3 if `var' == "Some of the time"
  8.         replace `var'_n = 4 if `var' == "Most of the time"
  9.         replace `var'_n = 5 if `var' == "All of the time"
 10.     }
 11.     else {
 12.         /* Numeric variable (already coded 1-5): use directly */
.         gen `var'_n = `var'
 13.     }
 14. }

. 
. /* K10 score: sum of the 10 items */
. egen k10_score = rowtotal(tired_n nervous_n sonervous_n hopeless_n ///
>     restless_n sorestless_n depressed_n everythingeffort_n ///
>     nothingcheerup_n worthless_n), missing

. 
. gen depression_cat = .
(9,407 missing values generated)

. replace depression_cat = 0 if k10_score >= 10 & k10_score <= 19
(6,728 real changes made)

. replace depression_cat = 1 if k10_score >= 20 & k10_score <= 24
(1,711 real changes made)

. replace depression_cat = 2 if k10_score >= 25 & k10_score <= 29
(712 real changes made)

. replace depression_cat = 3 if k10_score >= 30 & k10_score <= 50
(256 real changes made)

. 
. gen depressed_binary = (k10_score >= 20) if k10_score < .

. egen k10_std = std(k10_score)

. 
. keep FPrimary hhmid k10_score k10_std depression_cat depressed_binary ///
>     tired_n nervous_n sonervous_n hopeless_n restless_n sorestless_n ///
>     depressed_n everythingeffort_n nothingcheerup_n worthless_n

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_depression.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_depression.dta saved

. 
. /*--- 2C. Cognitive Tests (Wave 2) ---*/
. 
. /* Raven's */
. use "$data/Wave 2/09c_ravenspattern.dta", clear
(b09c_ravenspattern)

. 
. /* Correct answers same as Wave 1 */
. gen ravens_correct = 0

. local answers "d e a b f c f b a c e b"

. cap confirm string variable c_01

. if _rc == 0 {
.     /* String: compare directly */
.     local i = 1
.     foreach ans of local answers {
  2.         local j = string(`i', "%02.0f")
  3.         cap replace ravens_correct = ravens_correct + (lower(c_`j') == "`a
> ns'") if !missing(c_`j')
  4.         local i = `i' + 1
  5.     }
. }

. else {
.     /* Numeric with value labels: decode first */
.     local i = 1
.     foreach ans of local answers {
  2.         local j = string(`i', "%02.0f")
  3.         cap decode c_`j', gen(_tmp_r)
  4.         cap replace ravens_correct = ravens_correct + (lower(_tmp_r) == "`
> ans'") if !missing(c_`j')
  5.         cap drop _tmp_r
  6.         local i = `i' + 1
  7.     }
. }

. 
. egen ravens_std = std(ravens_correct)

. keep FPrimary hhmid age gender ravens_correct ravens_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_ravens.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_ravens.dta saved

. 
. /* Digit Span (combined forward and backward in Wave 2) */
. use "$data/Wave 2/09b_digitspantest.dta", clear
(b09b_digitspantest)

. 
. /* Forward: levels b1_01 through b1_08 */
. gen dsf_score = 0

. cap confirm string variable b1_01a

. if _rc == 0 {
.     forvalues lev = 1/8 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap gen pass_`lev' = (b1_`l'a == "Correct" | b1_`l'b == "Correct" 
> | ///
>             b1_`l'c == "Correct") if !missing(b1_`l'a)
  4.         cap replace dsf_score = `lev' if pass_`lev' == 1
  5.     }
. }

. else {
.     forvalues lev = 1/8 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap decode b1_`l'a, gen(_ta)
  4.         cap decode b1_`l'b, gen(_tb)
  5.         cap decode b1_`l'c, gen(_tc)
  6.         cap gen pass_`lev' = (_ta == "Correct" | _tb == "Correct" | ///
>             _tc == "Correct") if !missing(b1_`l'a)
  7.         cap drop _ta _tb _tc
  8.         cap replace dsf_score = `lev' if pass_`lev' == 1
  9.     }
. }

. 
. /* Backward: levels b2_09 through b2_15 */
. gen dsb_score = 0

. cap confirm string variable b2_09a

. if _rc == 0 {
.     forvalues lev = 9/15 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap gen pass_`lev' = (b2_`l'a == "Correct" | b2_`l'b == "Correct" 
> | ///
>             b2_`l'c == "Correct") if !missing(b2_`l'a)
  4.         cap replace dsb_score = (`lev' - 8) if pass_`lev' == 1
  5.     }
. }

. else {
.     forvalues lev = 9/15 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap decode b2_`l'a, gen(_ta)
  4.         cap decode b2_`l'b, gen(_tb)
  5.         cap decode b2_`l'c, gen(_tc)
  6.         cap gen pass_`lev' = (_ta == "Correct" | _tb == "Correct" | ///
>             _tc == "Correct") if !missing(b2_`l'a)
  7.         cap drop _ta _tb _tc
  8.         cap replace dsb_score = (`lev' - 8) if pass_`lev' == 1
  9.     }
. }

. 
. egen dsf_std = std(dsf_score)
(4,617 missing values generated)

. egen dsb_std = std(dsb_score)
(4,617 missing values generated)

. 
. keep FPrimary hhmid dsf_score dsf_std dsb_score dsb_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_digitspan.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_digitspan.dta saved

. 
. /* Math */
. use "$data/Wave 2/09d_math.dta", clear
(b09d_math)

. gen math_correct = 0

. cap confirm string variable d_01

. if _rc == 0 {
.     forvalues i = 1/8 {
  2.         local j = string(`i', "%02.0f")
  3.         cap replace math_correct = math_correct + (d_`j' == "Correct") if 
> !missing(d_`j')
  4.     }
. }

. else {
.     forvalues i = 1/8 {
  2.         local j = string(`i', "%02.0f")
  3.         cap decode d_`j', gen(_tmp_d)
  4.         cap replace math_correct = math_correct + (_tmp_d == "Correct") if
>  !missing(d_`j')
  5.         cap drop _tmp_d
  6.     }
. }

. egen math_std = std(math_correct)
(5,463 missing values generated)

. keep FPrimary hhmid math_correct math_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_math.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_math.dta saved

. 
. /* English */
. use "$data/Wave 2/09e_english.dta", clear
(b09e_english)

. gen english_correct = 0

. cap confirm string variable e_09

. if _rc == 0 {
.     forvalues i = 9/15 {
  2.         local j = string(`i', "%02.0f")
  3.         cap replace english_correct = english_correct + (e_`j' == "Correct
> ") if !missing(e_`j')
  4.     }
. }

. else {
.     forvalues i = 9/15 {
  2.         local j = string(`i', "%02.0f")
  3.         cap decode e_`j', gen(_tmp_e)
  4.         cap replace english_correct = english_correct + (_tmp_e == "Correc
> t") if !missing(e_`j')
  5.         cap drop _tmp_e
  6.     }
. }

. egen english_std = std(english_correct)
(5,463 missing values generated)

. keep FPrimary hhmid english_correct english_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_english.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_english.dta saved

. 
. /*--- 2D. Anthropometry (Wave 2) ---*/
. use "$data/Wave 2/06b_anthropometry.dta", clear
(b06b_anthropometry)

. 
. rename height height_cm

. rename weight_ weight_kg

. rename armcircumference arm_circumference

. 
. keep FPrimary hhmid age gender height_cm weight_kg arm_circumference

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_anthro.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_anthro.dta saved

. 
. /*--- 2E. Care for Kids (Wave 2) ---*/
. use "$data/Wave 2/10avi_careforkids.dta", clear
(bcarekids)

. 
. /* Key variables: readhomeworkhours, readhomeworkminutes,
>    otherhours, otherminutes, sleepinghours, daysworkperweek */
. gen read_hw_time = readhomeworkhours + readhomeworkminutes / 60
(6,780 missing values generated)

. gen other_child_time = otherhours + otherminutes / 60
(6,781 missing values generated)

. gen total_child_time = read_hw_time + other_child_time
(6,781 missing values generated)

. 
. cap confirm string variable careforkids

. if _rc == 0 {
.     gen careforkids_yn = (careforkids == "Yes") if !missing(careforkids)
. }

. else {
.     cap decode careforkids, gen(_tmp_ck)
.     gen careforkids_yn = (_tmp_ck == "Yes") if !missing(careforkids)
.     cap drop _tmp_ck
. }

. 
. keep FPrimary hhmid careforkids_yn read_hw_time other_child_time ///
>     total_child_time sleepinghours sleepingminutes daysworkperweek

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_childcare.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_childcare.dta saved

. 
. /*--- 2F. Employment (Wave 2) ---*/
. use "$data/Wave 2/01ei_employmentmain.dta", clear
(b01ei_employmentmain)

. 
. rename jobweeksperyear weeks_year

. rename jobdaysperweek days_week

. rename jobhoursperday hours_day

. rename paidamount pay_amount

. 
. gen annual_hours = weeks_year * days_week * hours_day
(1 missing value generated)

. gen weekly_hours = days_week * hours_day
(1 missing value generated)

. 
. keep FPrimary hhmid weeks_year days_week hours_day pay_amount ///
>     annual_hours weekly_hours paid paidperiod

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_employment.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_employment.dta saved

. 
. /*--- 2G. Education (Wave 2) ---*/
. use "$data/Wave 2/01fi_generaleducation.dta", clear
(b01fi_generaleducation)

. 
. rename highestgrade highest_grade_w2

. rename attended ever_attended_w2

. cap confirm string variable attendingstill

. if _rc == 0 {
.     gen attending_school = (attendingstill == "Yes") if !missing(attendingsti
> ll)
. }

. else {
.     cap decode attendingstill, gen(_tmp_as)
.     gen attending_school = (_tmp_as == "Yes") if !missing(attendingstill)
(10,011 missing values generated)
.     cap drop _tmp_as
. }

. 
. keep FPrimary hhmid highest_grade_w2 ever_attended_w2 attending_school gender

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_education.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_education.dta saved

. 
. /*--- 2H. Health (Wave 2) ---*/
. use "$data/Wave 2/06f_past2weeks.dta", clear
(b06f_past2weeks)

. 
. keep FPrimary hhmid anyillness howmanydays stopactivities howmanystop ///
>     consultfacility

. rename anyillness ill_2weeks

. rename howmanydays days_sick

. rename stopactivities stopped_activities

. rename howmanystop days_stopped

. rename consultfacility consulted_facility

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 2

. save "$temp/w2_health2wk.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_health2wk.dta saved

. 
. /*--- 2I. Immunization (Wave 2) ---*/
. use "$data/Wave 2/06c_immunization.dta", clear
(b06c_immunization)

. 
. /* Variable names may differ in Wave 2 */
. ds, has(type string)
FPrimary

. /* Count vaccines */
. keep FPrimary hhmid

. gen wave = 2

. save "$temp/w2_immunization.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_immunization.dta saved

. 
. /*--- 2J. Insurance (Wave 2) ---*/
. use "$data/Wave 2/06a_insurance.dta", clear
(b06a_insurance)

. 
. keep FPrimary hhmid

. gen wave = 2

. save "$temp/w2_insurance.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_insurance.dta saved

. 
. /*--- 2K. Consumption (Wave 2) ---*/
. use "$data/Wave 2/11a_foodcomsumption_prod_purch.dta", clear
(b11a_foodcomsumption_prod_purch)

. collapse (sum) food_own = producedcedis food_purch = purchasedcedis, by(FPrim
> ary)

. gen total_food_exp = food_own + food_purch

. gen wave = 2

. save "$temp/w2_foodcons.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_foodcons.dta saved

. 
. 
. /*===========================================================================
> ===
>     PART 3: PROCESS WAVE 3 DATA
> =============================================================================
> =*/
. 
. /*--- 3A. Demographics (Wave 3) ---*/
. use "$data/Wave 3/01b2_roster.dta", clear

. 
. rename ageyears age_w3

. rename agemonths age_months_w3

. 
. cap confirm string variable gender

. if _rc == 0 {
.     gen female = (gender == "Female")
. }

. else {
.     decode gender, gen(_gender_str)
.     gen female = (_gender_str == "Female")
.     drop _gender_str
. }

. 
. /* Identify mothers and children */
. cap confirm string variable relationship

. if _rc == 0 {
.     gen mother_w3 = (female == 1) & ///
>         (relationship == "Head" | relationship == "Spouse" | ///
>          relationship == "Parent/Parent-in-law") & ///
>         (age_w3 >= 15 & age_w3 < .)
.     gen child_w3 = (relationship == "Child" | ///
>         relationship == "Adopted, foster/stepchild" | ///
>         relationship == "Grandchild") & ///
>         (age_w3 >= 0 & age_w3 <= 17)
. }

. else {
.     decode relationship, gen(_rel_str)
.     gen mother_w3 = (female == 1) & ///
>         (_rel_str == "Head" | _rel_str == "Spouse" | ///
>          _rel_str == "Parent/Parent-in-law") & ///
>         (age_w3 >= 15 & age_w3 < .)
.     gen child_w3 = (_rel_str == "Child" | ///
>         _rel_str == "Adopted, foster/stepchild" | ///
>         _rel_str == "Grandchild") & ///
>         (age_w3 >= 0 & age_w3 <= 17)
.     drop _rel_str
. }

. 
. keep FPrimary index hhmid hhmid_original gender age_w3 age_months_w3 ///
>     female mother_w3 child_w3 relationship new_mem maritalstatus

. gen wave = 3

. save "$temp/w3_demographics.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_demographics.dta saved

. 
. /*--- 3B. Depression (Wave 3) ---*/
. use "$data/Wave 3/10ai_depression.dta", clear

. 
. /* In Wave 3: interviewedid = hhmid */
. rename interviewedid hhmid

. 
. /* K10 items - same descriptive names as Wave 2.
>    Items may be numeric (1-5 with value labels) or string. Handle both. */
. foreach var in tired nervous hopeless restless depressed ///
>     everythingeffort nothingcheerup worthless sonervous sorestless {
  2.     cap confirm string variable `var'
  3.     if _rc == 0 {
  4.         /* String variable: recode from text to numeric */
.         gen `var'_n = .
  5.         replace `var'_n = 1 if `var' == "None of the time"
  6.         replace `var'_n = 2 if `var' == "A little of the time"
  7.         replace `var'_n = 3 if `var' == "Some of the time"
  8.         replace `var'_n = 4 if `var' == "Most of the time"
  9.         replace `var'_n = 5 if `var' == "All of the time"
 10.     }
 11.     else {
 12.         /* Numeric variable (already coded 1-5): use directly */
.         gen `var'_n = `var'
 13.     }
 14. }
(1,099 missing values generated)
(1,098 missing values generated)
(1,101 missing values generated)
(1,102 missing values generated)
(1,100 missing values generated)
(1,106 missing values generated)
(1,101 missing values generated)
(1,100 missing values generated)
(1,098 missing values generated)
(1,103 missing values generated)

. 
. /* Wave 3 also has a pre-computed 'kessler' variable */
. rename kessler kessler_precomputed

. 
. egen k10_score = rowtotal(tired_n nervous_n sonervous_n hopeless_n ///
>     restless_n sorestless_n depressed_n everythingeffort_n ///
>     nothingcheerup_n worthless_n), missing
(1,094 missing values generated)

. 
. gen depression_cat = .
(11,666 missing values generated)

. replace depression_cat = 0 if k10_score >= 10 & k10_score <= 19
(7,131 real changes made)

. replace depression_cat = 1 if k10_score >= 20 & k10_score <= 24
(1,898 real changes made)

. replace depression_cat = 2 if k10_score >= 25 & k10_score <= 29
(1,109 real changes made)

. replace depression_cat = 3 if k10_score >= 30 & k10_score <= 50
(428 real changes made)

. 
. gen depressed_binary = (k10_score >= 20) if k10_score < .
(1,094 missing values generated)

. egen k10_std = std(k10_score)
(1,094 missing values generated)

. 
. keep FPrimary hhmid k10_score k10_std depression_cat depressed_binary ///
>     kessler_precomputed tired_n nervous_n sonervous_n hopeless_n ///
>     restless_n sorestless_n depressed_n everythingeffort_n ///
>     nothingcheerup_n worthless_n

. 
. /* Drop duplicate hhmid within FPrimary (take first observation) */
. bysort FPrimary hhmid: keep if _n == 1
(2 observations deleted)

. 
. gen wave = 3

. save "$temp/w3_depression.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_depression.dta saved

. 
. /*--- 3C. Cognitive Tests (Wave 3) ---*/
. 
. /* Raven's */
. use "$data/Wave 3/01ei_ravens.dta", clear

. 
. gen ravens_correct = 0

. local answers "d e a b f c f b a c e b"

. cap confirm string variable ravens_01

. if _rc == 0 {
.     local i = 1
.     foreach ans of local answers {
  2.         local j = string(`i', "%02.0f")
  3.         cap replace ravens_correct = ravens_correct + ///
>             (lower(ravens_`j') == "`ans'") if !missing(ravens_`j')
  4.         local i = `i' + 1
  5.     }
. }

. else {
.     local i = 1
.     foreach ans of local answers {
  2.         local j = string(`i', "%02.0f")
  3.         cap decode ravens_`j', gen(_tmp_r)
  4.         cap replace ravens_correct = ravens_correct + ///
>             (lower(_tmp_r) == "`ans'") if !missing(ravens_`j')
  5.         cap drop _tmp_r
  6.         local i = `i' + 1
  7.     }
. }

. 
. egen ravens_std = std(ravens_correct)

. keep FPrimary index hhmid age ravens_correct ravens_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_ravens.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_ravens.dta saved

. 
. /* Digit Span (Wave 3) */
. use "$data/Wave 3/01ev_digitspan.dta", clear

. 
. /* Forward: forwards_01 through forwards_08 */
. gen dsf_score = 0

. cap confirm string variable forwards_01a

. if _rc == 0 {
.     forvalues lev = 1/8 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap gen pass_`lev' = (forwards_`l'a == "Correct" | ///
>             forwards_`l'b == "Correct" | ///
>             forwards_`l'c == "Correct") if !missing(forwards_`l'a)
  4.         cap replace dsf_score = `lev' if pass_`lev' == 1
  5.     }
. }

. else {
.     forvalues lev = 1/8 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap decode forwards_`l'a, gen(_ta)
  4.         cap decode forwards_`l'b, gen(_tb)
  5.         cap decode forwards_`l'c, gen(_tc)
  6.         cap gen pass_`lev' = (_ta == "Correct" | _tb == "Correct" | ///
>             _tc == "Correct") if !missing(forwards_`l'a)
  7.         cap drop _ta _tb _tc
  8.         cap replace dsf_score = `lev' if pass_`lev' == 1
  9.     }
. }

. 
. /* Backward: backwards_09 through backwards_15 */
. gen dsb_score = 0

. cap confirm string variable backwards_09a

. if _rc == 0 {
.     forvalues lev = 9/15 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap gen pass_`lev' = (backwards_`l'a == "Correct" | ///
>             backwards_`l'b == "Correct" | ///
>             backwards_`l'c == "Correct") if !missing(backwards_`l'a)
  4.         cap replace dsb_score = (`lev' - 8) if pass_`lev' == 1
  5.     }
. }

. else {
.     forvalues lev = 9/15 {
  2.         local l = string(`lev', "%02.0f")
  3.         cap decode backwards_`l'a, gen(_ta)
  4.         cap decode backwards_`l'b, gen(_tb)
  5.         cap decode backwards_`l'c, gen(_tc)
  6.         cap gen pass_`lev' = (_ta == "Correct" | _tb == "Correct" | ///
>             _tc == "Correct") if !missing(backwards_`l'a)
  7.         cap drop _ta _tb _tc
  8.         cap replace dsb_score = (`lev' - 8) if pass_`lev' == 1
  9.     }
. }

. 
. egen dsf_std = std(dsf_score)
(17,103 missing values generated)

. egen dsb_std = std(dsb_score)
(17,103 missing values generated)

. 
. keep FPrimary index hhmid dsf_score dsf_std dsb_score dsb_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_digitspan.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_digitspan.dta saved

. 
. /* Math (Wave 3) */
. use "$data/Wave 3/01eiii_math.dta", clear

. 
. /* Wave 3 has math_score pre-computed and math_01_yn through math_08_yn */
. gen math_correct = 0

. cap confirm string variable math_01_yn

. if _rc == 0 {
.     forvalues i = 1/8 {
  2.         local j = string(`i', "%02.0f")
  3.         cap replace math_correct = math_correct + (math_`j'_yn == "Correct
> ") ///
>             if !missing(math_`j'_yn)
  4.     }
. }

. else {
.     forvalues i = 1/8 {
  2.         local j = string(`i', "%02.0f")
  3.         cap decode math_`j'_yn, gen(_tmp_m)
  4.         cap replace math_correct = math_correct + (_tmp_m == "Correct") //
> /
>             if !missing(math_`j'_yn)
  5.         cap drop _tmp_m
  6.     }
. }

. 
. /* Use pre-computed score if available */
. cap replace math_correct = math_score if !missing(math_score)

. 
. egen math_std = std(math_correct)

. keep FPrimary index hhmid math_correct math_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_math.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_math.dta saved

. 
. /* English (Wave 3) */
. use "$data/Wave 3/01evi_english.dta", clear

. 
. gen english_correct = 0

. cap confirm string variable english_09_yn

. if _rc == 0 {
.     forvalues i = 9/15 {
  2.         local j = string(`i', "%02.0f")
  3.         cap replace english_correct = english_correct + ///
>             (english_`j'_yn == "Correct") if !missing(english_`j'_yn)
  4.     }
. }

. else {
.     forvalues i = 9/15 {
  2.         local j = string(`i', "%02.0f")
  3.         cap decode english_`j'_yn, gen(_tmp_e)
  4.         cap replace english_correct = english_correct + ///
>             (_tmp_e == "Correct") if !missing(english_`j'_yn)
  5.         cap drop _tmp_e
  6.     }
. }

. 
. cap replace english_correct = english_score if !missing(english_score)

. 
. egen english_std = std(english_correct)

. keep FPrimary index hhmid english_correct english_std

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_english.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_english.dta saved

. 
. /* NEPSY (Wave 3 only) */
. use "$data/Wave 3/01eiv_nepsy.dta", clear

. 
. rename naming_task_score nepsy_naming

. rename inhibit_task_score nepsy_inhibit

. 
. keep FPrimary index hhmid nepsy_naming nepsy_inhibit

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_nepsy.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_nepsy.dta saved

. 
. /*--- 3D. Anthropometry (Wave 3) ---*/
. use "$data/Wave 3/01evii_anthropometry.dta", clear

. 
. rename height height_cm

. rename weight weight_kg

. rename armcircumference arm_circumference

. 
. keep FPrimary index hhmid age height_cm weight_kg arm_circumference

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_anthro.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_anthro.dta saved

. 
. /*--- 3E. Care for Kids (Wave 3) ---*/
. use "$data/Wave 3/10avi_careforkids.dta", clear

. 
. rename interviewedid hhmid

. gen read_hw_time = readhomeworkhours + readhomeworkminutes / 60
(9,802 missing values generated)

. gen other_child_time = otherhours + otherminutes / 60
(9,775 missing values generated)

. gen math_help_time = mathhours + mathminutes / 60
(9,770 missing values generated)

. gen english_help_time = englishhours + englishminutes / 60
(9,769 missing values generated)

. gen total_child_time = read_hw_time + other_child_time + ///
>     math_help_time + english_help_time
(9,835 missing values generated)

. 
. cap confirm string variable careforkids

. if _rc == 0 {
.     gen careforkids_yn = (careforkids == "Yes") if !missing(careforkids)
. }

. else {
.     cap decode careforkids, gen(_tmp_ck)
.     gen careforkids_yn = (_tmp_ck == "Yes") if !missing(careforkids)
(1,090 missing values generated)
.     cap drop _tmp_ck
. }

. 
. /* Drop duplicates */
. bysort FPrimary hhmid: keep if _n == 1
(2 observations deleted)

. 
. keep FPrimary hhmid careforkids_yn read_hw_time other_child_time ///
>     total_child_time math_help_time english_help_time ///
>     sleepinghours sleepingminutes daysworkperweek

. gen wave = 3

. save "$temp/w3_childcare.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_childcare.dta saved

. 
. /*--- 3F. Employment (Wave 3) ---*/
. use "$data/Wave 3/01fi_employmentmain.dta", clear

. 
. rename jobweeksperyear weeks_year

. rename jobdaysperweek days_week

. rename jobhoursperday hours_day

. rename paidamount pay_amount

. 
. gen annual_hours = weeks_year * days_week * hours_day
(37 missing values generated)

. gen weekly_hours = days_week * hours_day
(14 missing values generated)

. 
. keep FPrimary hhmid weeks_year days_week hours_day pay_amount ///
>     annual_hours weekly_hours paid paidperiod

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_employment.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_employment.dta saved

. 
. /*--- 3G. Consumption (Wave 3) ---*/
. use "$data/Wave 3/11a_foodconsumption_prod_purch.dta", clear

. collapse (sum) food_own = producedcedis food_purch = purchasedcedis, by(FPrim
> ary)

. gen total_food_exp = food_own + food_purch

. gen wave = 3

. save "$temp/w3_foodcons.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_foodcons.dta saved

. 
. /*--- 3H. Health (Wave 3) ---*/
. use "$data/Wave 3/06f_past2weeks.dta", clear

. 
. rename anyillness ill_2weeks

. rename howmanydays days_sick

. rename stopactivities stopped_activities

. rename howmanystop days_stopped

. rename consultfacility consulted_facility

. 
. keep FPrimary hhmid ill_2weeks days_sick stopped_activities ///
>     days_stopped consulted_facility

. duplicates drop FPrimary hhmid, force

Duplicates in terms of FPrimary hhmid

(0 observations are duplicates)

. gen wave = 3

. save "$temp/w3_health2wk.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_health2wk.dta saved

. 
. 
. /*===========================================================================
> ===
>     PART 4: MERGE WITHIN EACH WAVE
> =============================================================================
> =*/
. 
. /*--- Wave 1 Master Dataset ---*/
. use "$temp/w1_demographics.dta", clear

. 
. /* Merge depression */
. merge 1:1 FPrimary hhmid using "$temp/w1_depression.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         8,851
        from master                     8,851  
        from using                          0  

    Matched                            10,038  
    -----------------------------------------

. 
. /* Merge cognitive tests - these are at child level */
. merge 1:1 FPrimary hhmid using "$temp/w1_ravens.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        13,777
        from master                    13,777  
        from using                          0  

    Matched                             5,112  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w1_dsf.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        13,752
        from master                    13,752  
        from using                          0  

    Matched                             5,137  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w1_dsb.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        17,969
        from master                    17,969  
        from using                          0  

    Matched                               920  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w1_math.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        13,962
        from master                    13,962  
        from using                          0  

    Matched                             4,927  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w1_english.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        14,612
        from master                    14,612  
        from using                          0  

    Matched                             4,277  
    -----------------------------------------

. 
. /* Merge anthropometry */
. merge 1:1 FPrimary hhmid using "$temp/w1_anthro.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           143
        from master                       143  
        from using                          0  

    Matched                            18,746  
    -----------------------------------------

. 
. /* Merge education */
. merge 1:1 FPrimary hhmid using "$temp/w1_education.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            18,889  
    -----------------------------------------

. 
. /* Merge employment */
. merge 1:1 FPrimary hhmid using "$temp/w1_employment.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        17,476
        from master                    17,476  
        from using                          0  

    Matched                             1,413  
    -----------------------------------------

. 
. /* Merge health */
. merge 1:1 FPrimary hhmid using "$temp/w1_health2wk.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                            58
        from master                        58  
        from using                          0  

    Matched                            18,831  
    -----------------------------------------

. 
. /* Merge immunization */
. merge 1:1 FPrimary hhmid using "$temp/w1_immunization.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                            58
        from master                        58  
        from using                          0  

    Matched                            18,831  
    -----------------------------------------

. 
. /* Merge insurance */
. merge 1:1 FPrimary hhmid using "$temp/w1_insurance.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                            97
        from master                        97  
        from using                          0  

    Matched                            18,792  
    -----------------------------------------

. 
. /* Merge childcare */
. merge 1:1 FPrimary hhmid using "$temp/w1_childcare.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         6,654
        from master                     6,654  
        from using                          0  

    Matched                            12,235  
    -----------------------------------------

. 
. /* Merge household-level consumption */
. merge m:1 FPrimary hhid using "$temp/w1_foodcons.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           174
        from master                       174  
        from using                          0  

    Matched                            18,715  
    -----------------------------------------

. merge m:1 FPrimary hhid using "$temp/w1_clothing.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           181
        from master                       181  
        from using                          0  

    Matched                            18,708  
    -----------------------------------------

. merge m:1 FPrimary hhid using "$temp/w1_otheritems.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           174
        from master                       174  
        from using                          0  

    Matched                            18,715  
    -----------------------------------------

. merge m:1 FPrimary hhid using "$temp/w1_fuel.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           175
        from master                       175  
        from using                          0  

    Matched                            18,714  
    -----------------------------------------

. 
. /* Merge household info */
. merge m:1 FPrimary using "$temp/w1_hhinfo.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            18,889  
    -----------------------------------------

. 
. /* Merge household cover */
. merge m:1 FPrimary hhid using "$temp/w1_hhcover.dta", ///
>     keep(master match) nogen
(label urbrur already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            18,889  
    -----------------------------------------

. 
. save "$temp/w1_master.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_master.dta saved

. 
. /*--- Wave 2 Master Dataset ---*/
. use "$temp/w2_demographics.dta", clear
(b01d_background)

. 
. merge 1:1 FPrimary hhmid using "$temp/w2_depression.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         6,947
        from master                     6,947  
        from using                          0  

    Matched                             9,407  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_ravens.dta", ///
>     keep(master match) nogen
(label tgender already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                        11,737
        from master                    11,737  
        from using                          0  

    Matched                             4,617  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_digitspan.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        11,737
        from master                    11,737  
        from using                          0  

    Matched                             4,617  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_math.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        10,891
        from master                    10,891  
        from using                          0  

    Matched                             5,463  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_english.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        10,891
        from master                    10,891  
        from using                          0  

    Matched                             5,463  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_anthro.dta", ///
>     keep(master match) nogen
(variable age was byte, now int to accommodate using data's values)
(label tgender already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            16,354  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_childcare.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         6,947
        from master                     6,947  
        from using                          0  

    Matched                             9,407  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_employment.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        15,197
        from master                    15,197  
        from using                          0  

    Matched                             1,157  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_education.dta", ///
>     keep(master match) nogen
(label tgender already defined)
(label tyesno already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,039
        from master                     1,039  
        from using                          0  

    Matched                            15,315  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w2_health2wk.dta", ///
>     keep(master match) nogen
(label tyesno already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            16,354  
    -----------------------------------------

. 
. /* Household-level consumption */
. merge m:1 FPrimary using "$temp/w2_foodcons.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             7
        from master                         7  
        from using                          0  

    Matched                            16,347  
    -----------------------------------------

. 
. save "$temp/w2_master.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w2_master.dta saved

. 
. /*--- Wave 3 Master Dataset ---*/
. use "$temp/w3_demographics.dta", clear

. 
. merge 1:1 FPrimary hhmid using "$temp/w3_depression.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         9,926
        from master                     9,926  
        from using                          0  

    Matched                             9,080  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_ravens.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,903
        from master                     1,903  
        from using                          0  

    Matched                            17,103  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_digitspan.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,903
        from master                     1,903  
        from using                          0  

    Matched                            17,103  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_math.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,903
        from master                     1,903  
        from using                          0  

    Matched                            17,103  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_english.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,903
        from master                     1,903  
        from using                          0  

    Matched                            17,103  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_nepsy.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,903
        from master                     1,903  
        from using                          0  

    Matched                            17,103  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_anthro.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            19,006  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_childcare.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         9,926
        from master                     9,926  
        from using                          0  

    Matched                             9,080  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_employment.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                        17,525
        from master                    17,525  
        from using                          0  

    Matched                             1,481  
    -----------------------------------------

. merge 1:1 FPrimary hhmid using "$temp/w3_health2wk.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            19,006  
    -----------------------------------------

. 
. /* Household-level consumption */
. merge m:1 FPrimary using "$temp/w3_foodcons.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                            57
        from master                        57  
        from using                          0  

    Matched                            18,949  
    -----------------------------------------

. 
. save "$temp/w3_master.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w3_master.dta saved

. 
. 
. /*===========================================================================
> ===
>     PART 5: APPEND WAVES INTO PANEL
> =============================================================================
> =*/
. 
. /* First, harmonize variable names across waves */
. /* Wave 1 uses 'age', Wave 2 uses 'age_w2', Wave 3 uses 'age_w3' */
. 
. use "$temp/w1_master.dta", clear

. 
. /* Harmonize FPrimary type: Wave 1 has numeric, Waves 2-3 have string */
. cap confirm string variable FPrimary

. if _rc != 0 {
.     tostring FPrimary, replace force
FPrimary was long now str9
. }

. 
. gen age_harmonized = age
(5 missing values generated)

. append using "$temp/w2_master.dta"
(variable pay_amount was long, now double to accommodate using data's values)

. replace age_harmonized = age_w2 if wave == 2
(16,336 real changes made)

. append using "$temp/w3_master.dta"
(variable FPrimary was str9, now str14 to accommodate using data's values)
(variable sleepinghours was byte, now int to accommodate using data's values)
(variable sleepingminutes was byte, now int to accommodate using data's
       values)
(variable daysworkperweek was byte, now int to accommodate using data's
       values)
(variable weeks_year was byte, now int to accommodate using data's values)
(variable days_week was byte, now int to accommodate using data's values)
(variable hours_day was byte, now int to accommodate using data's values)
(variable paidperiod was byte, now int to accommodate using data's values)
(variable ill_2weeks was byte, now int to accommodate using data's values)
(variable days_sick was byte, now int to accommodate using data's values)
(variable days_stopped was byte, now int to accommodate using data's values)

. replace age_harmonized = age_w3 if wave == 3
(19,006 real changes made)

. 
. /* Create unique person ID */
. egen person_id = group(FPrimary hhmid)

. 
. /* Create household ID */
. egen hh_id = group(FPrimary)

. 
. /* Sort panel */
. sort person_id wave

. 
. save "$temp/panel_all_individuals.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/panel_all_individuals.dta saved

. 
. 
. /*===========================================================================
> ===
>     PART 6: CONSTRUCT ANALYSIS VARIABLES
> =============================================================================
> =*/
. 
. use "$temp/panel_all_individuals.dta", clear

. 
. /*--- 6A. Total Household Consumption ---*/
. gen total_consumption = total_food_exp + clothing_exp + other_exp + fuel_exp
(35,542 missing values generated)

. replace total_consumption = total_food_exp if missing(total_consumption) & //
> /
>     !missing(total_food_exp)
(35,304 real changes made)

. 
. /* Per capita consumption */
. bysort FPrimary wave: gen hh_size = _N

. gen pc_consumption = total_consumption / hh_size
(238 missing values generated)

. gen ln_pc_consumption = ln(pc_consumption)
(373 missing values generated)

. 
. /*--- 6B. Construct Composite Cognitive Score ---*/
. /* Principal component of available test scores */
. /* We standardize within each wave to account for test difficulty changes */
. 
. forvalues w = 1/3 {
  2.     foreach var in ravens_correct dsf_score dsb_score math_correct english
> _correct {
  3.         cap egen `var'_std_w`w' = std(`var') if wave == `w'
  4.     }
  5. }

. 
. /* Simple average of available standardized scores as cognitive index */
. egen cog_index = rowmean(ravens_std dsf_std dsb_std math_std english_std)
(27,417 missing values generated)

. 
. /* Also keep individual test z-scores for robustness */
. 
. /*--- 6C. Height-for-Age Z-Score (HAZ) ---*/
. /* Approximate HAZ using WHO standards */
. /* HAZ = (height - median_height) / SD_height for age and sex */
. /* For simplicity, compute age-sex standardized height */
. 
. bysort wave female: egen mean_height = mean(height_cm) if age_harmonized <= 1
> 7
(30,472 missing values generated)

. bysort wave female: egen sd_height = sd(height_cm) if age_harmonized <= 17
(30,472 missing values generated)

. gen haz_approx = (height_cm - mean_height) / sd_height if age_harmonized <= 1
> 7
(32,349 missing values generated)

. 
. /* Weight-for-age z-score */
. bysort wave female: egen mean_weight = mean(weight_kg) if age_harmonized <= 1
> 7
(30,472 missing values generated)

. bysort wave female: egen sd_weight = sd(weight_kg) if age_harmonized <= 17
(30,472 missing values generated)

. gen waz_approx = (weight_kg - mean_weight) / sd_weight if age_harmonized <= 1
> 7
(32,366 missing values generated)

. 
. /* BMI for adults */
. gen bmi = weight_kg / (height_cm/100)^2 if height_cm > 0 & weight_kg > 0
(4,456 missing values generated)

. 
. /*--- 6D. Education Variables ---*/
. /* Harmonize education across waves */
. gen mother_educ_years = .
(54,249 missing values generated)

. /* Wave 1: highest_grade_w1 may be string or numeric with value labels */
. /* Create a string version for safe comparison */
. cap confirm string variable highest_grade_w1

. if _rc != 0 {
.     decode highest_grade_w1, gen(_hg_str)
. }

. else {
.     gen _hg_str = highest_grade_w1
. }

. replace mother_educ_years = 0 if _hg_str == "None" & wave == 1
(642 real changes made)

. replace mother_educ_years = 1 if _hg_str == "P1" & wave == 1
(717 real changes made)

. replace mother_educ_years = 2 if _hg_str == "P2" & wave == 1
(784 real changes made)

. replace mother_educ_years = 3 if _hg_str == "P3" & wave == 1
(766 real changes made)

. replace mother_educ_years = 4 if _hg_str == "P4" & wave == 1
(728 real changes made)

. replace mother_educ_years = 5 if _hg_str == "P5" & wave == 1
(777 real changes made)

. replace mother_educ_years = 6 if _hg_str == "P6" & wave == 1
(923 real changes made)

. replace mother_educ_years = 7 if inlist(_hg_str, "JSS1", "Middle 1") & wave =
> = 1
(576 real changes made)

. replace mother_educ_years = 8 if inlist(_hg_str, "JSS2", "Middle 2") & wave =
> = 1
(524 real changes made)

. replace mother_educ_years = 9 if inlist(_hg_str, "JSS3", "Middle 3", "Middle/
> JSS") & wave == 1
(1,240 real changes made)

. replace mother_educ_years = 10 if _hg_str == "SSS1" & wave == 1
(198 real changes made)

. replace mother_educ_years = 11 if _hg_str == "SSS2" & wave == 1
(143 real changes made)

. replace mother_educ_years = 12 if _hg_str == "SSS3" & wave == 1
(632 real changes made)

. drop _hg_str

. 
. /* Generate education category */
. gen educ_cat = .
(54,249 missing values generated)

. replace educ_cat = 0 if mother_educ_years == 0  // No education
(642 real changes made)

. replace educ_cat = 1 if mother_educ_years >= 1 & mother_educ_years <= 6  // P
> rimary
(4,695 real changes made)

. replace educ_cat = 2 if mother_educ_years >= 7 & mother_educ_years <= 9  // J
> HS
(2,340 real changes made)

. replace educ_cat = 3 if mother_educ_years >= 10 & mother_educ_years <= 12  //
>  SHS
(973 real changes made)

. replace educ_cat = 4 if mother_educ_years > 12 & mother_educ_years < .  // Te
> rtiary
(0 real changes made)

. 
. 
. /*===========================================================================
> ===
>     PART 7: CREATE MOTHER-CHILD LINKED DATASET
> =============================================================================
> =*/
. 
. /* This is the key step: link each child to their mother within the household
>  */
. 
. /* Step 1: Identify mothers in each household-wave */
. preserve

.     keep if mother == 1 | mother_w2_v2 == 1 | mother_w3 == 1
(39,131 observations deleted)

.     keep FPrimary hhmid wave k10_score k10_std depression_cat depressed_binar
> y ///
>         age_harmonized mother_educ_years educ_cat weekly_hours pay_amount ///
>         total_parental_time read_hw_time other_child_time total_child_time //
> /
>         careforkids_yn nhis_registered nhis_valid_card bmi ///
>         height_cm weight_kg days_childcare_week_w1 daysworkperweek ///
>         depressed_precoded depression_score_precoded kessler_precomputed

. 
.     /* Rename to indicate these are mother's variables */
.     foreach var in k10_score k10_std depression_cat depressed_binary ///
>         age_harmonized mother_educ_years educ_cat weekly_hours pay_amount ///
>         total_parental_time read_hw_time other_child_time total_child_time //
> /
>         careforkids_yn nhis_registered nhis_valid_card bmi ///
>         height_cm weight_kg days_childcare_week_w1 daysworkperweek {
  2.         rename `var' m_`var'
  3.     }

.     rename hhmid mother_hhmid

. 
.     /* Keep one mother per household-wave (primary female) */
.     bysort FPrimary wave: keep if _n == 1
(2,472 observations deleted)

. 
.     save "$temp/mothers_panel.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/mothers_panel.dta saved

. restore

. 
. /* Step 2: Keep children */
. preserve

.     keep if child == 1 | child_w2 == 1 | child_w3 == 1
(31,312 observations deleted)

.     keep FPrimary hhmid wave age_harmonized female child_female ///
>         ravens_correct ravens_std dsf_score dsf_std dsb_score dsb_std ///
>         math_correct math_std english_correct english_std ///
>         cog_index haz_approx waz_approx height_cm weight_kg ///
>         arm_circumference attending_school ///
>         ill_2weeks days_sick stopped_activities days_stopped ///
>         consulted_facility immun_count immun_rate ///
>         nepsy_naming nepsy_inhibit ///
>         person_id hh_id hh_size ///
>         total_food_exp total_consumption pc_consumption ln_pc_consumption ///
>         clothing_exp other_exp fuel_exp ///
>         urbrur

. 
.     /* Rename child variables */
.     rename age_harmonized c_age

.     rename female c_female

.     rename height_cm c_height

.     rename weight_kg c_weight

.     rename arm_circumference c_arm_circ

.     rename hhmid child_hhmid

. 
.     save "$temp/children_panel.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/children_panel.dta saved

. restore

. 
. /* Step 3: Merge mothers and children */
. use "$temp/children_panel.dta", clear

. 
. merge m:1 FPrimary wave using "$temp/mothers_panel.dta", ///
>     keep(master match) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           544
        from master                       544  
        from using                          0  

    Matched                            22,393  
    -----------------------------------------

. 
. /* Add household-level controls (geographic identifiers are time-invariant) *
> /
. /* Drop wave from hhcover before merging so it matches all waves */
. preserve

.     use "$temp/w1_hhcover.dta", clear

.     drop wave

.     /* Convert FPrimary to string to match panel */
.     cap confirm string variable FPrimary

.     if _rc != 0 {
.         tostring FPrimary, replace force
FPrimary was long now str9
.     }

.     save "$temp/w1_hhcover_nowave.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/temp/w1_hhcover_nowave.dta saved

. restore

. merge m:1 FPrimary using "$temp/w1_hhcover_nowave.dta", ///
>     keep(master match) nogen
(label urbrur already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,380
        from master                     1,380  
        from using                          0  

    Matched                            21,557  
    -----------------------------------------

. 
. /* Create EA-level fixed effect.
>    Since hhcover comes from Wave 1, all matched HHs have regioncode/districtc
> ode/eacode */
. egen ea_id = group(regioncode districtcode eacode) if !missing(eacode)
(1,380 missing values generated)

. 
. /* Household-level consumption */
. gen ln_total_food = ln(total_food_exp) if total_food_exp > 0
(132 missing values generated)

. 
. /* Create wave dummies */
. gen wave2 = (wave == 2)

. gen wave3 = (wave == 3)

. 
. /*--- Child age groups ---*/
. gen c_age_group = .
(22,937 missing values generated)

. replace c_age_group = 1 if c_age >= 0 & c_age <= 4   // Early childhood
(6,109 real changes made)

. replace c_age_group = 2 if c_age >= 5 & c_age <= 9   // Middle childhood
(7,024 real changes made)

. replace c_age_group = 3 if c_age >= 10 & c_age <= 14  // Early adolescence
(6,586 real changes made)

. replace c_age_group = 4 if c_age >= 15 & c_age <= 17  // Late adolescence
(3,218 real changes made)

. 
. label define age_grp 1 "0-4" 2 "5-9" 3 "10-14" 4 "15-17"

. label values c_age_group age_grp

. 
. 
. /*===========================================================================
> ===
>     PART 8: SAMPLE RESTRICTIONS AND FINAL CLEANING
> =============================================================================
> =*/
. 
. /* Keep only observations with non-missing maternal depression */
. gen has_maternal_dep = !missing(m_k10_score)

. 
. /* Keep only observations where child has at least one cognitive test */
. gen has_cog_test = !missing(ravens_correct) | !missing(dsf_score) | ///
>     !missing(dsb_score) | !missing(math_correct) | !missing(english_correct)

. 
. /* Analysis sample: mother-child pairs with depression data and cognitive tes
> ts */
. gen analysis_sample = (has_maternal_dep == 1 & has_cog_test == 1)

. 
. /* Label key variables */
. label variable m_k10_score "Maternal K10 Depression Score"

. label variable m_k10_std "Maternal K10 Score (Standardized)"

. label variable m_depressed_binary "Maternal Depression (K10 >= 20)"

. label variable cog_index "Child Cognitive Index (Avg of Std Scores)"

. label variable ravens_std "Raven's Score (Standardized)"

. label variable dsf_std "Digit Span Forward (Standardized)"

. label variable dsb_std "Digit Span Backward (Standardized)"

. label variable math_std "Math Score (Standardized)"

. label variable english_std "English Score (Standardized)"

. label variable haz_approx "Height-for-Age Z-Score (Approx)"

. label variable waz_approx "Weight-for-Age Z-Score (Approx)"

. label variable c_age "Child Age (Years)"

. label variable c_female "Child is Female"

. label variable m_age_harmonized "Mother's Age"

. label variable m_educ_cat "Mother's Education Level"

. label variable m_read_hw_time "Mother's Reading/Homework Time with Child (Hrs
> )"

. label variable m_total_child_time "Mother's Total Time with Child (Hrs)"

. label variable m_weekly_hours "Mother's Weekly Work Hours"

. label variable m_pay_amount "Mother's Pay Amount"

. label variable wave "Survey Wave (1=2009, 2=2012, 3=2018)"

. label variable hh_size "Household Size"

. label variable ln_pc_consumption "Log Per Capita Consumption"

. label variable analysis_sample "In Analysis Sample"

. 
. /* Save final analysis dataset */
. compress
  variable c_female was float now byte
  variable child_female was float now byte
  variable wave was float now byte
  variable ravens_correct was float now byte
  variable dsf_score was float now byte
  variable dsf_std was float now byte
  variable dsb_score was float now byte
  variable dsb_std was float now byte
  variable math_correct was float now byte
  variable english_correct was float now byte
  variable attending_school was float now byte
  variable ill_2weeks was int now byte
  variable days_sick was int now byte
  variable days_stopped was int now byte
  variable immun_count was float now byte
  variable c_age was float now byte
  variable person_id was float now int
  variable hh_id was float now int
  variable hh_size was float now byte
  variable m_k10_score was float now byte
  variable m_depression_cat was float now byte
  variable m_depressed_binary was float now byte
  variable m_weekly_hours was float now int
  variable m_nhis_registered was float now byte
  variable m_nhis_valid_card was float now byte
  variable m_age_harmonized was float now int
  variable m_daysworkperweek was int now byte
  variable m_careforkids_yn was float now byte
  variable m_mother_educ_years was float now byte
  variable m_educ_cat was float now byte
  variable ea_id was float now int
  variable wave2 was float now byte
  variable wave3 was float now byte
  variable c_age_group was float now byte
  variable has_maternal_dep was float now byte
  variable has_cog_test was float now byte
  variable analysis_sample was float now byte
  variable clothing_exp was double now int
  variable other_exp was double now int
  variable fuel_exp was double now int
  variable FPrimary was str14 now str10
  (2,752,440 bytes saved)

. save "$project/programs/stata/Draft1_Feb2026/analysis_data.dta", replace
file
    /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers/OU/Hea
    > lth/Ghana_mental_health/maternal_depression_child_cog_devlopment/progra
    > ms/stata/Draft1_Feb2026/analysis_data.dta saved

. 
. /* Report sample sizes */
. di _n "=============================================="

==============================================

. di "SAMPLE CONSTRUCTION SUMMARY"
SAMPLE CONSTRUCTION SUMMARY

. di "=============================================="
==============================================

. di "Total individual-wave observations: " _N
Total individual-wave observations: 22937

. tab wave if analysis_sample == 1, m

Survey Wave |
   (1=2009, |
    2=2012, |
    3=2018) |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      5,038       36.65       36.65
          2 |      4,508       32.79       69.45
          3 |      4,200       30.55      100.00
------------+-----------------------------------
      Total |     13,746      100.00

. tab c_age_group wave if analysis_sample == 1, m

           |   Survey Wave (1=2009, 2=2012,
c_age_grou |             3=2018)
         p |         1          2          3 |     Total
-----------+---------------------------------+----------
       0-4 |       137          7          0 |       144 
       5-9 |     2,162      1,967      1,657 |     5,786 
     10-14 |     1,943      1,723      1,737 |     5,403 
     15-17 |       796        811        806 |     2,413 
-----------+---------------------------------+----------
     Total |     5,038      4,508      4,200 |    13,746 

. di _n "Mother-child pairs with depression + cognitive data:"

Mother-child pairs with depression + cognitive data:

. count if analysis_sample == 1
  13,746

. 
. log close
      name:  <unnamed>
       log:  /Users/pallab.ghosh/Library/CloudStorage/Dropbox/D/Study/My_Papers
> /OU/Health/Ghana_mental_health/maternal_depression_child_cog_devlopment/progr
> ams/stata/Draft1_Feb2026/00_data_cleaning.log
  log type:  text
 closed on:  21 Feb 2026, 21:07:07
-------------------------------------------------------------------------------
